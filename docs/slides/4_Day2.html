<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>4_Day2.knit</title>
    <meta charset="utf-8" />
    <meta name="author" content="Selina Baldauf" />
    <script src="4_Day2_files/header-attrs-2.16/header-attrs.js"></script>
    <link href="4_Day2_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="4_Day2_files/panelset-0.2.6/panelset.css" rel="stylesheet" />
    <script src="4_Day2_files/panelset-0.2.6/panelset.js"></script>
    <script src="4_Day2_files/kePrint-0.0.1/kePrint.js"></script>
    <link href="4_Day2_files/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/new_slides.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">





class: inverse title-slide
background-image: url(img/rmarkdown.png)
background-size: 30%
background-position: 90% 90%

# Reproducible Documents with `{rmarkdown}`

## Day 2

### Instructor: [Selina Baldauf](https://www.bcp.fu-berlin.de/biologie/arbeitsgruppen/botanik/ag_tietjen/People/wissenschaftliche_programmierer/baldauf/index.html) &lt;br&gt;

### Freie Universität Berlin - Theoretical Ecology

.footnote-left[
  2022-22-03 (updated: 2022-09-13)
]


---

# Topics today

- Visual editor in RStudio

- Citations 

- Make tables look nice

- Some more tips and good practice

---

# The visual editor in RStudio

- WYSIWYG editor (*What you see is what you get*)

  - More similar to Word etc. but with less functionality
  
--
  
- Click on the button on the top left

![:scale 40%](img/day2/source_visual.png)

--

- Very helpful in the beginning until you remember how everything works in markdown

- Especially helpful for markdown tables and citations

--

- But careful: Can reformat the `.Rmd` file a bit, so sometimes if you switch back 
it can look different than before.

  - Best to choose the editor you like most and stick with it


---

# Adding citations - The classic way

Bibliographies can be included via a BibTeX data base.

--
  
- Create a `.bib` file that consists of bibliography entries
  
```bibtex
@Book{cookbook,
  title = {R Markdown Cookbook},
  author = {Yihui Xie and Christophe Dervieux and Emily Riederer},
  publisher = {Chapman and Hall/CRC},
  address = {Boca Raton, Florida},
  year = {2020},
  note = {ISBN 9780367563837},
  url = {https://bookdown.org/yihui/rmarkdown-cookbook},
  }
 ```

---

# Adding citations - The classic way

Bibliographies can be included via a BibTeX data base.

- Create a `.bib` file that consists of bibliography entries

- Add name and location of your `.bib` file as a medatada field in YAML header
  
```yaml
---
output: html_document
bibliography: references.bib
---
```

--

- Cite an article from the database with `@bib_item_name` for in text citations or
`[@bib_item_name]` for citation in brackets
  - Here, I cite `@cookbook` because it's a good book `[@cookbook]`
  - Here, I cite Xie, Dervieux, and Riederer (2020) because it’s a good book (Xie, Dervieux, and Riederer 2020)


--

- List of references used will be added to the end of the document
  - Just add a heading `# References` to end of the doc

---

# Adding citations - The classic way

- Add a custom citation style file with:

```yaml
---
output: html_document
bibliography: references.bib
csl: myrefstyle.csl
---
```

--

- Most (all?) reference managers can export your citations as a `.bib` file

---

# Adding citations - Visual editor

Citations can also be added using the **visual editor** in RStudio.

--

- Visual editor creates and updates `.bib` file automatically

--

- Search and add citations from
  - The bibliography file
  - Zotero
  - DOI
  - ...
  
---

# Adding citations - Visual editor

- Just click on the `Insert -&gt; citation`

![](img/day2/visual_editor_citation.png)

---

# Adding citations - Visual editor

- Select source of citation on the left (e.g. DOI, Zotero, ...)
- Click `Insert` to add citation to `bibliography.bib`


![:scale 60%](img/day2/insert_citation_window.png)

---

# Adding citations - Visual editor


- You can also start typing `@` and the editor will suggest you a list of citations that fit

![](img/day2/citation_insert.png)

---

# Adding citations - Visual editor

**Using Zotero**

- If you use Zotero on your machine, RStudio should automatically detect the installation

- If not, go to `Tools-&gt;Global Options-&gt;R Markdown -&gt; Citations` and enter the location
of your Zotero data directory and the library that you would like to use
  - In General this should be recognized automatically
  

---
class: inverse, middle, center

# .large[Now you]

## Task 1: Add some citations (20 mins)

#### Find the task description &lt;a href="https://selinazitrone.github.io/rmarkdown/tasks/day2/02_01_penguin_citation.html"&gt;here&lt;/a&gt;


---
class: inverse, middle, center

# .large[Nice looking tables in R Markdown]

---

# Nice looking tables with R Markdown

- The default for printing tables looks the same as printing it in the console:



```r
iris_sum
```

```
## # A tibble: 3 x 5
##   Species    Sepal.Length Sepal.Width Petal.Length Petal.Width
##   &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 setosa             5.01        3.43         1.46       0.246
## 2 versicolor         5.94        2.77         4.26       1.33 
## 3 virginica          6.59        2.97         5.55       2.03
```
- This is not really nice for documents

---

# `knitr::kable()`

Simple to use table generator from the `knitr` package.


```r
knitr::kable(iris_sum) # or iris_sum %&gt;% knitr::kable()
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Species &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Sepal.Length &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Sepal.Width &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Petal.Length &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Petal.Width &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; setosa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.006 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.428 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.462 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.246 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; versicolor &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.936 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.770 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.260 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.326 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; virginica &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.588 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.974 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.552 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.026 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

- Chose `kable` as default table printing in YAML header:

```yaml
df_print: "kable"
```

--

- `kable` works for PDF, HTML and Word output

---

# `knitr::kable()`

Add arguments for additional formatting:


```r
kable(x,
  format,
  digits = getOption("digits"),
  row.names = NA,
  col.names = NA,
  align, caption = NULL,
  label = NULL,
  format.args = list(),
  escape = TRUE, ...
)
```

- See [here](https://bookdown.org/yihui/rmarkdown-cookbook/kable.html) for many examples
many different use cases

---

# `knitr::kable()`

**Example:**


```r
knitr::kable(
  iris_sum,
  digits = 1,
  col.names = c("Species", "Sepal Length", "Sepal Width", "Petal Length", "Petal Width"),
  caption = "Summary of the Iris data",
  align = "l"
)
```

&lt;table&gt;
&lt;caption&gt;Summary of the Iris data&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Species &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Sepal Length &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Sepal Width &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Petal Length &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Petal Width &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; setosa &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 5.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3.4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; versicolor &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 5.9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 4.3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1.3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; virginica &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 6.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 5.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.0 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# The `{kableExtra}` package

- Provides options for table styling for HTML and PDF tables

--

- Most of the features work for both HTML and PDF tables

- Find the full documentation [here](https://haozhu233.github.io/kableExtra/)
  - If you use tables a lot, I recommend looking through the documentation to see
  all possibilities

--

- Load the packages in the setup chunk before using them


```r
library(knitr)
library(kableExtra)
```

--

- **Careful:** Don't load `kableExtra` for `word_document` output. This will break 
the tables made with `kable`

---

# The `{kableExtra}` package

**`kable_styling()`** is the basic styling function

- Use the pipe operator (`%&gt;%`) to pipe `kable()` output to styling function `kable_styling()`
  - Use the keyboard shortcut ` Ctrl/Cmd + Shift + M ` to insert ` %&gt;% `

--


```r
iris_sum %&gt;% 
  kable() %&gt;%
  kable_styling(
  full_width = FALSE, # display table on full page width?
  position = "center",  # if not full width -&gt; where to put table
  font_size = 15
)
```

&lt;table class="table" style="font-size: 15px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Species &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Sepal.Length &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Sepal.Width &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Petal.Length &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Petal.Width &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; setosa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.006 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.428 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.462 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.246 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; versicolor &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.936 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.770 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.260 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.326 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; virginica &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.588 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.974 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.552 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.026 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# The `{kableExtra}` package

**`kable_styling()`** provides styling options

- Additional styling options for HTML output are passed via `bootstrap_options`

--


```r
iris_sum %&gt;% 
  kable() %&gt;%
  kable_styling(
  full_width = FALSE, # display table on full page width?
  position = "center",  # if not full width -&gt; where 
  font_size = 15,
* bootstrap_options = c("striped", "hover")
)
```

&lt;table class="table lightable-classic lightable-striped lightable-hover" style='font-size: 15px; width: auto !important;  font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;'&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Species &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Sepal.Length &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Sepal.Width &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Petal.Length &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Petal.Width &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; setosa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.006 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.428 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.462 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.246 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; versicolor &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.936 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.770 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.260 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.326 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; virginica &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.588 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.974 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.552 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.026 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# The `{kableExtra}` package

**`kable_styling()`** provides styling options

- Additional styling options for PDF output are passed via `latex_options`


```r
iris_sum %&gt;%
* kable(booktabs = TRUE) %&gt;%
  kable_styling(
    full_width = FALSE,
    position = "center", 
    font_size = 15,
    bootstrap_options = c("striped", "hover"),
*   latex_options = c("striped", "hold_position", "scale_down")
  )
```

- `booktabs = TRUE` will use the `booktabs` LaTeX package to create nice horizontal lines and removes vertical lines
- `hold_position` places the table where it is created in the document (no floating)
- `scale_down` scales the text down to fit the table width

---

# The `{kableExtra}` package

**`kable_styling()`** provides styling options

- Additional styling options for PDF output are passed via `latex_options`


```r
iris_sum %&gt;%
* kable(booktabs = TRUE) %&gt;%
  kable_styling(
    full_width = FALSE,
    position = "center", 
    font_size = 15,
    bootstrap_options = c("striped", "hover"),
*   latex_options = c("striped", "hold_position", "scale_down")
  )
```

- Depending on the output format you chose, `bootstrap_options` or `latex_options` will be ignored

---

# The `{flextable}` package

--

- Works with PDF, HTML and Word output
  - Can be used as an option to style tables in Word

- Alternative to `kable` and `kableExtra`

- See [here](https://ardata-fr.github.io/flextable-book/index.html) for an extensive documentation
of the flextable package

---
class: inverse, middle, center

# .large[Now you]

## Task 3: Create a nice table (20 mins)

#### Find the task description &lt;a href="https://selinazitrone.github.io/rmarkdown/tasks/day2/02_02_penguin_tables.html"&gt;here&lt;/a&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
