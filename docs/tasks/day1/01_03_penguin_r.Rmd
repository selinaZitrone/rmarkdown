```{r include=FALSE}
library(palmerpenguins)
library(ggplot2)
library(dplyr)
```

## 2.1 Load the package

We will now write R code in the penguin document that analyses and plots the data from
the `palmerpenguins` package. 
As with "normal" R code, you also need to load the package in your document in the beginning.

You can do this in the `setup` code chunk.

Just add `library(palmerpenguins)` as a line in the chunk.

You can always come back to the setup chunk and add the packages that you need in 
your analysis. Then you have all the `library()` calls in one place.

## 2.1 Adding R code {.tabset}

Now let's add some R code that produces different types of output to the document.

Try using both the RStudio interface (`Code` -> `Insert Chunk`) and the keyboard 
shortcut (`Ctrl/Cmd + Alt/Option + I`) to insert the code chunks.

Remember that every time, you use a function from a package, you have to load the package into
the document environment. Just add another `library()` line to the setup chunk.

The different output types we will try are:

- A figure for the penguin data set
- A summary table of the data set
- Some statics using the penguin data set

For each of the three output types, go through the following steps:

1. Select a location in your document, where you want the output to be.
2. Insert a new code chunk at the location 
3. Write the code that produces the output (or copy from my examples below)
4. Run the code inside the document (Clicking on the little green arrow button next to the code chunk)
5. Knit the document and see how the output looks like

Below, you find example code for each of the three output types. I suggest, you copy the 
code to your respective chunk in the first step. Then if you still have time, you can 
also change the code or write code yourself.


### Figure {.tabset}

I use `ggplot` to produce the figure, so don't forget to load the package in the setup
chunk.

Chose one of the two figure ideas from below:

1. Create a histogram of the flipper length for the 3 penguin species

```{r eval=FALSE}
ggplot(penguins, aes(x = flipper_length_mm, fill = species)) +
  geom_histogram(alpha = 0.6) +
   scale_fill_manual(values = c("darkorange", "purple", "cyan4")) +
  theme_minimal()
```

2. Create a scatter plot of the relationship between bill length and bill depth

```{r eval=FALSE}
ggplot(
  data = penguins,
  aes(
    x = bill_length_mm,
    y = bill_depth_mm,
    color = species,
    shape = species
  )
) +
  geom_point(size = 3, alpha = 0.8) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_manual(values = c("darkorange", "purple", "cyan4")) +
  theme_minimal()
```

### Summary table

Add a summary table that shows the mean variable values grouped
by penguin species and sex. 

I use the `dplyr` package here, so don't forget to load it in the setup chunk.

```{r eval=FALSE}
penguins %>% 
  filter(!(is.na(sex))) %>% 
  group_by(species, sex) %>% 
  summarize(
    bill_length = mean(bill_length_mm, na.rm = TRUE),
    bill_depth = mean(bill_depth_mm, na.rm = TRUE),
    flipper_length = mean(flipper_length_mm, na.rm = TRUE),
    body_mass = mean(body_mass_g, na.rm = TRUE)
  )
```

### Some statistics

I used a Wilcoxon rank sum test, to compare the flipper length of male and female penguins:

```{r eval=FALSE}
# extract flipper length of male and female penuguins as a vector
females <- penguins %>% filter(sex == "female") %>% pull(flipper_length_mm)
males <- penguins %>% filter(sex == "male") %>% pull(flipper_length_mm)
# do the test
test <- wilcox.test(females, males)
test
```

## 2.1 Inline code

Try adding some sentences to the document that use R code to add some numbers.

Ideas are:

- Mean values of variables
- Species names

- The mean flipper length of all penguins is `r mean(penguins$flipper_length_mm, na.rm=TRUE)`.
- The islands that were investigated are `r unique(penguins$islands)`

#### Extra

Can you print the results of the wilcoxon test above into a nice sentence?

Something like: Male penguins have longer flippers than female penguins (Wilcoxon rank sum test, W = xyz, p = xyz).

You can access the elements of the test with `$`:

- `test$statistics` for the test statistics (in this case W)
- `test$p.value` for the p-value

### 2.3 Chunk options

Now add some chunk options to make the output nicer.

Start with the chunk that produces the figure:

- Add a figure caption.
- Change the figure size using either `fig.width` and `fig.height` or `out.width`

Knit the document again and look at the output.

Now think of global chunk options that might make sense for your document. Add the
ones that you like to have to the `knitr` options in the setup chunk.

You can for example think of things like:

- Should the R code be shown in the document?
- Should warnings and messages be printed into the document as well?

#### Extra

- Try different figure alignments